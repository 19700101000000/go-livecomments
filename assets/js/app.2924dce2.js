(function(t){function e(e){for(var n,r,a=e[0],c=e[1],l=e[2],m=0,d=[];m<a.length;m++)r=a[m],i[r]&&d.push(i[r][0]),i[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(d.length)d.shift()();return s.push.apply(s,l||[]),o()}function o(){for(var t,e=0;e<s.length;e++){for(var o=s[e],n=!0,a=1;a<o.length;a++){var c=o[a];0!==i[c]&&(n=!1)}n&&(s.splice(e--,1),t=r(r.s=o[0]))}return t}var n={},i={app:0},s=[];function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=n,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var u=c;s.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"17c6":function(t,e,o){"use strict";var n=o("f4f6"),i=o.n(n);i.a},"1c24":function(t,e,o){"use strict";var n=o("7552"),i=o.n(n);i.a},"56d7":function(t,e,o){"use strict";o.r(e);o("cadf"),o("551c"),o("f751"),o("097d");var n=o("2b0e"),i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("router-view")},s=[],r={name:"app"},a=r,c=o("2877"),l=Object(c["a"])(a,i,s,!1,null,null,null),u=l.exports,m=o("8c4f"),d=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-container",{staticClass:"h-100"},[o("b-row",{staticClass:"align-items-center h-100"},[o("b-col",{staticClass:"mx-auto",attrs:{sm:"6"}},[o("b-card",{staticClass:"text-center",attrs:{title:"LiveComments"}},[o("b-alert",{attrs:{show:t.isError,variant:"danger",dismissible:""},on:{dismissed:function(e){t.isError=!1}}},[t._v("\n          Connection failed.\n        ")]),o("b-button",{attrs:{variant:"outline-primary",size:"sm",disabled:t.isDisabled},on:{click:t.onClickNew}},[t.isDisabled?o("b-spinner",{attrs:{small:""}}):t._e(),t._v("\n          New Live\n        ")],1)],1)],1)],1)],1)},h=[],v=o("bc3a"),b=o.n(v),f={data:function(){return{isDisabled:!1,isError:!1}},methods:{onClickNew:function(){this.isDisabled=!0,window.setTimeout(this.newLive,800)},newLive:function(){var t=this;b.a.get("/api/newlive").then(function(e){t.$store.commit("livekey",e.data.livekey),t.$router.push({path:"/live"})}).catch(function(e){window.console.log(e),t.isError=!0,t.isDisabled=!1})}}},w=f,p=Object(c["a"])(w,d,h,!1,null,null,null),g=p.exports,C=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"h-100",style:{backgroundColor:t.getBgColor,color:t.getColor},attrs:{id:"live-screen"},on:{mousemove:t.onMouseMove}},[o("b-container",{staticClass:"h-100",staticStyle:{position:"relative"}},[o("b-row",{staticClass:"h-100 align-items-center"},[o("b-col",{staticClass:"text-center mx-auto"},[o("timer",{staticClass:"display-1"})],1)],1),o("b-row",{staticClass:"connection-error w-100"},[o("b-col",{staticClass:"mt-3"},[o("b-alert",{attrs:{variant:"danger",show:t.isError}},[t._v("\n          Connection Fail.\n        ")])],1)],1)],1),o("live-menu",{staticClass:"text-body",style:t.styles.liveScreenMenu,attrs:{comments:t.comments},on:{autoHide:t.onChangeMenuAutoHide}})],1)},k=[],y=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-container",{staticClass:"h-100",attrs:{id:"live-screen-menu",fluid:""}},[o("b-row",{staticClass:"h-25 pt-3"},[o("b-col",[o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-qr",modifiers:{"modal-qr":!0}}],attrs:{variant:"outline-light"}},[o("font-awesome-icon",{attrs:{icon:"qrcode"}})],1),o("b-modal",{staticClass:"text-center",attrs:{id:"modal-qr",centered:"","hide-header":"","hide-footer":""},on:{show:t.onShowModal,hide:t.onHideModal}},[o("qrcode-vue",{staticClass:"m-4",attrs:{value:t.qrValue,size:400}})],1)],1),o("b-col",{staticClass:"text-right"},[o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-comments",modifiers:{"modal-comments":!0}}],attrs:{variant:"outline-light"}},[o("font-awesome-icon",{attrs:{icon:"list"}})],1),o("b-modal",{staticClass:"text-left",attrs:{id:"modal-comments",title:"Comments History",size:"lg",scrollable:""},on:{show:t.onShowModal,hide:t.onHideModal}},[o("b-table",{attrs:{striped:"",hover:"",fields:t.commentFields,items:t.comments}}),o("div",{staticClass:"text-right",attrs:{slot:"modal-footer"},slot:"modal-footer"},[o("b-button",{attrs:{variant:"outline-secondary"},on:{click:t.onOutputCSV}},[t._v("\n            Output CSV\n          ")])],1)],1)],1)],1),o("b-row",{staticClass:"h-50 align-items-center"},[o("b-col",{staticClass:"mx-auto text-light",attrs:{sm:"6"}},[o("timer-controller")],1)],1),o("b-row",{staticClass:"h-25 align-items-end pb-3"},[o("b-col",[o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-settings",modifiers:{"modal-settings":!0}}],attrs:{variant:"outline-light"}},[o("font-awesome-icon",{attrs:{icon:"cog"}})],1),o("b-modal",{attrs:{id:"modal-settings",title:"Settings",centered:"","hide-footer":""},on:{show:t.onShowModal,hide:t.onHideModal}},[o("live-settings")],1)],1)],1)],1)},x=[],T=(o("a481"),o("d7b0")),_=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-card",{staticClass:"bg-transparent text-center",attrs:{"border-variant":"light"}},[o("timer"),o("b-row",[o("b-col",{attrs:{sm:"2"}}),o("b-col",{attrs:{sm:"8"}},[o("b-button",{attrs:{variant:"outline-light"},on:{click:t.onClickToggle}},[t.active?o("font-awesome-icon",{attrs:{icon:"pause"}}):o("font-awesome-icon",{attrs:{icon:"play"}})],1),o("b-button",{staticClass:"ml-3",attrs:{variant:"outline-light"},on:{click:t.onClickStop}},[o("font-awesome-icon",{attrs:{icon:"stop"}})],1)],1),o("b-col",{staticClass:"text-right",attrs:{sm:"2"}},[o("b-button",{attrs:{variant:"outline-light",disabled:""}},[o("font-awesome-icon",{attrs:{icon:"cog"}})],1)],1)],1)],1)},S=[],M=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("p",{staticClass:"timer mb-0"},[t._v(t._s(t.timer))]),o("p",{staticClass:"count"},[t._v(t._s(t.count))])])},$=[],E={computed:{timer:function(){var t=this.$store.state.timer.time,e=this.$store.state.timer.count,o=t-e,n=1e3,i=60*n,s=Math.floor(o/i),r=Math.floor(o%i/n);return"".concat("0".concat(s).slice(-2),":").concat("0".concat(r).slice(-2))},count:function(){var t=this.$store.state.timer.count,e=1e3,o=60*e,n=Math.floor(t/o),i=Math.floor(t%o/e);return"".concat("0".concat(n).slice(-2),":").concat("0".concat(i).slice(-2))}}},O=E,H=(o("17c6"),Object(c["a"])(O,M,$,!1,null,null,null)),j=H.exports,I={components:{Timer:j},data:function(){return{eventInterval:{countTimer:null}}},computed:{active:function(){return this.$store.state.timer.active}},methods:{onClickToggle:function(){this.$store.commit("activeTimer",!this.active),this.active?this.eventInterval.countTimer=window.setInterval(this.countTimer,1e3):this.clearTimer()},onClickStop:function(){this.eventInterval.countTimer&&this.clearTimer(),this.$store.commit("stopTimer")},countTimer:function(){this.$store.commit("countTimer",1e3),this.$store.state.timer===this.$store.state.count&&(this.$store.commit("activeTimer",!1),this.clearTimer())},clearTimer:function(){window.clearInterval(this.eventInterval.countTimer),this.eventInterval.countTimer=null}}},D=I,B=Object(c["a"])(D,_,S,!1,null,null,null),L=B.exports,N=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("b-form-group",{attrs:{label:"Background Color"}},[o("b-form-radio-group",{attrs:{"button-variant":"outline-dark",buttons:""},on:{change:t.onChangeBgColor},model:{value:t.bgColor,callback:function(e){t.bgColor=e},expression:"bgColor"}},[o("b-form-radio",{attrs:{value:"black"}},[t._v("\n        Black\n      ")]),o("b-form-radio",{attrs:{value:"white"}},[t._v("\n        White\n      ")])],1)],1)],1)},P=[],q={data:function(){return{bgColor:this.$store.state.bgColor}},methods:{onChangeBgColor:function(t){var e="black";"black"===t&&(e="white"),this.$store.commit("setBgColor",t),this.$store.commit("setColor",e)}}},z=q,W=Object(c["a"])(z,N,P,!1,null,null,null),A=W.exports,V={components:{QrcodeVue:T["a"],TimerController:L,LiveSettings:A},props:["comments"],data:function(){return{autoHide:!0,qrValue:"https://".concat(window.location.host,"/comment/").concat(this.$store.state.livekey||""),commentFields:[{key:"datetime",sortable:!0},{key:"comment",sortable:!1}]}},methods:{onShowModal:function(){this.autoHide=!1,this.$emit("autoHide",this.autoHide)},onHideModal:function(){this.autoHide=!0,this.$emit("autoHide",this.autoHide)},onOutputCSV:function(){var t="datetime,comment\n";for(var e in this.comments)t+="".concat(this.comments[e].datetime,",").concat(this.comments[e].comment.replace(/,/g,"&comma;"),"\n");var o=window.document.createElement("a");o.href="data:text/csv;charset=utf-8,"+encodeURI(t),o.target="_blank",o.download="comments.csv",o.click()}}},F=V,J=(o("1c24"),Object(c["a"])(F,y,x,!1,null,null,null)),R=J.exports,G=o("7e3c"),Q={components:{LiveMenu:R,Timer:j},data:function(){return{comments:[],isError:!1,menuAutoHide:!0,eventTimeout:{hideMenu:null,reopen:null},eventInterval:{sendPing:null},styles:{liveScreenMenu:{display:"none",position:"absolute",zIndex:"1",top:"0"}},socket:null}},computed:{getBgColor:function(){return this.$store.state.bgColor},getColor:function(){return this.$store.state.color}},methods:{onChangeMenuAutoHide:function(t){this.clearTimeout(),this.menuAutoHide=t,this.menuAutoHide&&this.onMouseMove()},addComment:function(t){this.comments.push(t);var e=window.document.createTextNode(t.comment),o=window.document.createElement("p");o.className="comment",o.appendChild(e),o.style.top="".concat(t.top,"%"),o.style.color=t.color,o.style.webkitTextStrokeColor=this.$store.state.bgColor,o.animate([{marginLeft:"100%",widh:"100%"},{marginLeft:"-".concat(t.comment.length,"em"),widh:"100%"}],4e3).onfinish=function(){o.remove()};var n=window.document.getElementsByClassName("comment");n.length>50&&n[0].remove();var i=window.document.getElementById("live-screen");i.appendChild(o)},onMouseMove:function(){var t=this;this.styles.liveScreenMenu.display="block",this.clearTimeout(),this.menuAutoHide&&(this.eventTimeout.hideMenu=window.setTimeout(function(){t.styles.liveScreenMenu.display="none"},2e3))},clearTimeout:function(){window.clearTimeout(this.eventTimeout.hideMenu)},connectionWS:function(){var t=this;this.socket=new G["w3cwebsocket"]("ws://".concat(window.location.host,"/ws/").concat(this.$store.state.livekey)),this.socket.onmessage=function(e){"ping"!==e.data&&t.addComment(JSON.parse(e.data))},this.socket.onopen=function(e){window.console.log("websocket open"),window.console.log(e),t.isError=!1},this.socket.onerror=function(t){window.console.log("websocket error"),window.console.log(t)},this.socket.onclose=function(e){window.console.log("websocket close"),window.console.log(e),t.isError=!0,t.eventTimeout.reopen=window.setTimeout(function(){t.connectionWS()},1e3)},this.eventInterval.sendPing=window.setInterval(function(){t.socket.send("ping")},6e4)}},beforeCreate:function(){null===this.$store.state.livekey&&this.$router.push({path:"/"})},created:function(){this.connectionWS()},destroyed:function(){this.socket.close(),window.clearTimeout(this.eventTimeout.reopen),window.clearInterval(this.eventInterval.sendPing)}},U=Q,Y=(o("ba4a"),Object(c["a"])(U,C,k,!1,null,null,null)),K=Y.exports,X=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-container",[o("b-row",{staticClass:"mt-3"},[o("b-col",[o("b-card",{attrs:{title:"Comment Form"}},[o("b-card-text",[o("b-form",{on:{submit:t.onSubmit}},[o("b-input-group",[o("b-form-input",{style:{color:t.color},attrs:{type:"text",state:t.commentState,disabled:t.isDisabled,placeholder:"your comment"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),o("b-input-group-append",[o("b-button",{attrs:{type:"submit",variant:t.commentState?"outline-success":"outline-danger",disabled:!t.commentState||t.isDisabled}},[t.isSending?o("b-spinner",{attrs:{small:"",variant:"success"}}):o("font-awesome-icon",{attrs:{icon:"paper-plane"}})],1)],1)],1),o("b-form-text",{staticClass:"text-right"},[t._v("\n              "+t._s(t.comment.length)+"/"+t._s(t.commentLimit)+"\n            ")])],1)],1),o("b-card-sub-title",[t._v("Text Color")]),o("b-card-text",[o("b-form",[o("b-form-radio-group",{model:{value:t.color,callback:function(e){t.color=e},expression:"color"}},t._l(t.colors,function(e,n){return o("b-form-radio",{key:n,style:{color:e.value},attrs:{value:e.value}},[t._v(t._s(e.text))])}),1)],1)],1),o("b-card-sub-title",[t._v("Shortcuts")]),o("b-card-text",[o("b-button",{staticClass:"m-2",attrs:{variant:"outline-success",size:"sm",disabled:!1},on:{click:t.onClickShortcut}},[t._v("いいね")]),o("b-button",{staticClass:"m-2",attrs:{variant:"outline-success",size:"sm",disabled:!1},on:{click:t.onClickShortcut}},[t._v("気になる")]),o("b-button",{staticClass:"m-2",attrs:{variant:"outline-success",size:"sm",disabled:!1},on:{click:t.onClickShortcut}},[t._v("すこ")])],1)],1),o("b-alert",{staticClass:"mt-3",attrs:{show:t.isError,variant:"danger"}},[t._v("\n        Connection fail.\n      ")])],1)],1)],1)},Z=[],tt=o("f499"),et=o.n(tt),ot={data:function(){return{comment:"",color:"inherit",colors:[{value:"inherit",text:"Default"},{value:"red",text:"Red"},{value:"yellow",text:"Yellow"},{value:"green",text:"Green"},{value:"cyan",text:"Cyan"},{value:"blue",text:"Blue"},{value:"magenta",text:"Magenta"}],commentLimit:50,isDisabled:!1,isSending:!1,isError:!1,socket:null,eventTimeout:{reopen:null},eventInterval:{sendPing:null}}},computed:{commentState:function(){return this.comment.length>0&&this.comment.length<=this.commentLimit}},methods:{onSubmit:function(t){var e=this;t.preventDefault(),this.isDisabled=!0,this.isSending=!0,window.setTimeout(function(){e.isDisabled=!1,e.isSending=!1,e.comment=""},1e3),this.sendMsg(this.comment)},onClickShortcut:function(t){t.target.disabled=!0,window.setTimeout(function(){t.target.disabled=!1},1e3),this.sendMsg(t.target.textContent)},sendMsg:function(t){this.socket.send(et()({comment:t,color:this.color}))},connectionWS:function(){var t=this;this.socket=new G["w3cwebsocket"]("ws://".concat(window.location.host,"/ws/").concat(this.$route.params.id)),this.socket.onopen=function(e){window.console.log("websocket open"),window.console.log(e),t.isError=!1},this.socket.onerror=function(t){window.console.log("websocket error"),window.console.log(t)},this.socket.onclose=function(e){window.console.log("websocket close"),window.console.log(e),t.isError=!0,t.eventTimeout.reopen=window.setTimeout(function(){t.connectionWS()},1e3)}}},created:function(){this.connectionWS()},mounted:function(){},destroyed:function(){this.socket.close(),window.clearTimeout(this.eventTimeout.reopen)}},nt=ot,it=Object(c["a"])(nt,X,Z,!1,null,null,null),st=it.exports;n["a"].use(m["a"]);var rt=new m["a"]({mode:"history",routes:[{path:"/",component:g},{path:"/live",component:K},{path:"/comment/:id",component:st}]}),at=o("2f62");n["a"].use(at["a"]);var ct=new at["a"].Store({state:{bgColor:"white",color:"black",timer:{time:3e5,count:0,active:!1},livekey:null},mutations:{setColor:function(t,e){t.color=e},setBgColor:function(t,e){t.bgColor=e},countTimer:function(t,e){t.timer.count+=e,t.timer.count>=t.timer.time&&(t.timer.count=t.timer.time)},activeTimer:function(t,e){t.timer.active=e},stopTimer:function(t){t.timer.active=!1,t.timer.count=0},livekey:function(t,e){t.livekey=e}}}),lt=o("9f7b"),ut=o.n(lt);o("f9e3"),o("2dd8");n["a"].use(ut.a);var mt=o("ecee"),dt=o("c074"),ht=o("ad3d");mt["c"].add(dt["a"]),n["a"].component("font-awesome-icon",ht["a"]),n["a"].config.productionTip=!1,new n["a"]({router:rt,store:ct,render:function(t){return t(u)}}).$mount("#app")},7552:function(t,e,o){},ba4a:function(t,e,o){"use strict";var n=o("c5a5"),i=o.n(n);i.a},c5a5:function(t,e,o){},f4f6:function(t,e,o){}});
//# sourceMappingURL=app.2924dce2.js.map