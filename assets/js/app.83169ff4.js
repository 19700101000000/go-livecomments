(function(t){function e(e){for(var o,c,r=e[0],a=e[1],l=e[2],m=0,d=[];m<r.length;m++)c=r[m],i[c]&&d.push(i[c][0]),i[c]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o]);u&&u(e);while(d.length)d.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],o=!0,r=1;r<n.length;r++){var a=n[r];0!==i[a]&&(o=!1)}o&&(s.splice(e--,1),t=c(c.s=n[0]))}return t}var o={},i={app:0},s=[];function c(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=t,c.c=o,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)c.d(n,o,function(e){return t[e]}.bind(null,o));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],a=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=a;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"17c6":function(t,e,n){"use strict";var o=n("f4f6"),i=n.n(o);i.a},"1c24":function(t,e,n){"use strict";var o=n("7552"),i=n.n(o);i.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var o=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-view")},s=[],c={name:"app"},r=c,a=n("2877"),l=Object(a["a"])(r,i,s,!1,null,null,null),u=l.exports,m=n("8c4f"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",{staticClass:"h-100"},[n("b-row",{staticClass:"align-items-center h-100"},[n("b-col",{staticClass:"mx-auto",attrs:{sm:"6"}},[n("b-card",{staticClass:"text-center",attrs:{title:"LiveComments"}},[n("b-alert",{attrs:{show:t.isError,variant:"danger",dismissible:""},on:{dismissed:function(e){t.isError=!1}}},[t._v("\n          Connection failed.\n        ")]),n("b-button",{attrs:{variant:"outline-primary",size:"sm",disabled:t.isDisabled},on:{click:t.onClickNew}},[t.isDisabled?n("b-spinner",{attrs:{small:""}}):t._e(),t._v("\n          New Live\n        ")],1)],1)],1)],1)],1)},h=[],f=n("bc3a"),v=n.n(f),b={data:function(){return{isDisabled:!1,isError:!1}},methods:{onClickNew:function(){this.isDisabled=!0,window.setTimeout(this.newLive,800)},newLive:function(){var t=this;v.a.get("/api/newlive").then(function(e){t.$store.commit("livekey",e.data.livekey),t.$router.push({path:"/live"})}).catch(function(e){window.console.log(e),t.isError=!0,t.isDisabled=!1})}}},w=b,p=Object(a["a"])(w,d,h,!1,null,null,null),g=p.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100",style:t.styles.liveScreen,attrs:{id:"live-screen"},on:{mousemove:t.onMouseMove}},[n("b-container",{staticClass:"h-100",staticStyle:{position:"relative"}},[n("b-row",{staticClass:"h-100 align-items-center"},[n("b-col",{staticClass:"text-center mx-auto"},[n("timer",{staticClass:"display-1"})],1)],1),n("b-row",{staticClass:"connection-error w-100"},[n("b-col",{staticClass:"mt-3"},[n("b-alert",{attrs:{variant:"danger",show:t.isError}},[t._v("\n          Connection Fail.\n        ")])],1)],1)],1),n("live-menu",{style:t.styles.liveScreenMenu,on:{autoHide:t.onChangeMenuAutoHide}})],1)},k=[],T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",{staticClass:"h-100",attrs:{id:"live-screen-menu",fluid:""}},[n("b-row",{staticClass:"h-25 pt-3"},[n("b-col",[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-qr",modifiers:{"modal-qr":!0}}],attrs:{variant:"outline-light"}},[n("font-awesome-icon",{attrs:{icon:"qrcode"}})],1),n("b-modal",{staticClass:"text-center",attrs:{id:"modal-qr",centered:"","hide-header":"","hide-footer":""},on:{show:t.onFocusQR,hide:t.onBlurQR}},[n("qrcode-vue",{staticClass:"m-4",attrs:{value:t.qrValue,size:400}})],1)],1),n("b-col",{staticClass:"text-right"},[n("b-button",{attrs:{variant:"outline-light",disabled:""}},[n("font-awesome-icon",{attrs:{icon:"list"}})],1)],1)],1),n("b-row",{staticClass:"h-50 align-items-center"},[n("b-col",{staticClass:"mx-auto text-light",attrs:{sm:"6"}},[n("timer-controller")],1)],1),n("b-row",{staticClass:"h-25 align-items-end pb-3"},[n("b-col",[n("b-button",{attrs:{variant:"outline-light",disabled:""}},[n("font-awesome-icon",{attrs:{icon:"cog"}})],1)],1)],1)],1)},y=[],S=n("d7b0"),_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-card",{staticClass:"bg-transparent text-center",attrs:{"border-variant":"light"}},[n("timer"),n("b-row",[n("b-col",{attrs:{sm:"2"}}),n("b-col",{attrs:{sm:"8"}},[n("b-button",{attrs:{variant:"outline-light"},on:{click:t.onClickToggle}},[t.active?n("font-awesome-icon",{attrs:{icon:"pause"}}):n("font-awesome-icon",{attrs:{icon:"play"}})],1),n("b-button",{staticClass:"ml-3",attrs:{variant:"outline-light"},on:{click:t.onClickStop}},[n("font-awesome-icon",{attrs:{icon:"stop"}})],1)],1),n("b-col",{staticClass:"text-right",attrs:{sm:"2"}},[n("b-button",{attrs:{variant:"outline-light",disabled:""}},[n("font-awesome-icon",{attrs:{icon:"cog"}})],1)],1)],1)],1)},x=[],$=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",{staticClass:"timer mb-0"},[t._v(t._s(t.timer))]),n("p",{staticClass:"count"},[t._v(t._s(t.count))])])},M=[],E={computed:{timer:function(){var t=this.$store.state.timer.time,e=this.$store.state.timer.count,n=t-e,o=1e3,i=60*o,s=Math.floor(n/i),c=Math.floor(n%i/o);return"".concat("0".concat(s).slice(-2),":").concat("0".concat(c).slice(-2))},count:function(){var t=this.$store.state.timer.count,e=1e3,n=60*e,o=Math.floor(t/n),i=Math.floor(t%n/e);return"".concat("0".concat(o).slice(-2),":").concat("0".concat(i).slice(-2))}}},O=E,j=(n("17c6"),Object(a["a"])(O,$,M,!1,null,null,null)),I=j.exports,H={components:{Timer:I},data:function(){return{eventInterval:{countTimer:null}}},computed:{active:function(){return this.$store.state.timer.active}},methods:{onClickToggle:function(){this.$store.commit("activeTimer",!this.active),this.active?this.eventInterval.countTimer=window.setInterval(this.countTimer,1e3):this.clearTimer()},onClickStop:function(){this.eventInterval.countTimer&&this.clearTimer(),this.$store.commit("stopTimer")},countTimer:function(){this.$store.commit("countTimer",1e3),this.$store.state.timer===this.$store.state.count&&(this.$store.commit("activeTimer",!1),this.clearTimer())},clearTimer:function(){window.clearInterval(this.eventInterval.countTimer),this.eventInterval.countTimer=null}}},D=H,L=Object(a["a"])(D,_,x,!1,null,null,null),P=L.exports,q={components:{QrcodeVue:S["a"],TimerController:P},data:function(){return{autoHide:!0,qrValue:"https://".concat(window.location.host,"/comment/").concat(this.$store.state.livekey||"")}},methods:{onFocusQR:function(){this.autoHide=!1,this.$emit("autoHide",this.autoHide)},onBlurQR:function(){this.autoHide=!0,this.$emit("autoHide",this.autoHide)}}},N=q,z=(n("1c24"),Object(a["a"])(N,T,y,!1,null,null,null)),A=z.exports,W=n("7e3c"),Q={components:{LiveMenu:A,Timer:I},data:function(){return{comments:[],isError:!1,menuAutoHide:!0,eventTimeout:{hideMenu:null,reopen:null},eventInterval:{sendPing:null},styles:{liveScreen:{backgroundColor:this.$store.state.bgColor},liveScreenMenu:{display:"none",position:"absolute",zIndex:"1",top:"0"}},socket:null}},methods:{onChangeMenuAutoHide:function(t){window.console.log(t),this.clearTimeout(),this.menuAutoHide=t,this.menuAutoHide&&this.onMouseMove()},addComment:function(t){this.comments.push(t);var e=window.document.createTextNode(t.comment),n=window.document.createElement("p");n.className="comment",n.appendChild(e),n.style.top="".concat(t.top,"%"),n.animate([{marginLeft:"100%",widh:"100%"},{marginLeft:"-".concat(t.comment.length,"em"),widh:"100%"}],4e3).onfinish=function(){n.remove()};var o=window.document.getElementById("live-screen");o.appendChild(n)},onMouseMove:function(){var t=this;this.styles.liveScreenMenu.display="block",this.clearTimeout(),this.menuAutoHide&&(this.eventTimeout.hideMenu=window.setTimeout(function(){t.styles.liveScreenMenu.display="none"},2e3))},clearTimeout:function(){window.clearTimeout(this.eventTimeout.hideMenu)},connectionWS:function(){var t=this;this.socket=new W["w3cwebsocket"]("ws://".concat(window.location.host,"/ws/").concat(this.$store.state.livekey)),this.socket.onmessage=function(e){"ping"!==e.data&&t.addComment(JSON.parse(e.data))},this.socket.onopen=function(e){window.console.log("websocket open"),window.console.log(e),t.isError=!1},this.socket.onerror=function(t){window.console.log("websocket error"),window.console.log(t)},this.socket.onclose=function(e){window.console.log("websocket close"),window.console.log(e),t.isError=!0,t.eventTimeout.reopen=window.setTimeout(function(){t.connectionWS()},1e3)},this.eventInterval.sendPing=window.setInterval(function(){t.socket.send("ping")},6e4)}},beforeCreate:function(){null===this.$store.state.livekey&&this.$router.push({path:"/"})},created:function(){this.connectionWS()},destroyed:function(){this.socket.close(),window.clearTimeout(this.eventTimeout.reopen),window.clearInterval(this.eventInterval.sendPing)}},F=Q,R=(n("ba4a"),Object(a["a"])(F,C,k,!1,null,null,null)),B=R.exports,J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",[n("b-row",{staticClass:"mt-3"},[n("b-col",[n("b-card",{attrs:{title:"Comment Form"}},[n("b-card-text",[n("b-form",{on:{submit:t.onSubmit}},[n("b-input-group",[n("b-form-input",{attrs:{type:"text",state:t.commentState,disabled:t.isDisabled,placeholder:"your comment"},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}}),n("b-input-group-append",[n("b-button",{attrs:{type:"submit",variant:t.commentState?"outline-success":"outline-danger",disabled:!t.commentState||t.isDisabled}},[t.isSending?n("b-spinner",{attrs:{small:"",variant:"success"}}):n("font-awesome-icon",{attrs:{icon:"paper-plane"}})],1)],1)],1),n("b-form-text",{staticClass:"text-right"},[t._v("\n              "+t._s(t.comment.length)+"/"+t._s(t.commentLimit)+"\n            ")])],1)],1),n("b-card-sub-title",[t._v("Shortcuts")]),n("b-card-text",[n("b-button",{staticClass:"m-2",attrs:{variant:"outline-success",size:"sm",disabled:!1},on:{click:t.onClickShortcut}},[t._v("いいね")]),n("b-button",{staticClass:"m-2",attrs:{variant:"outline-success",size:"sm",disabled:!1},on:{click:t.onClickShortcut}},[t._v("気になる")]),n("b-button",{staticClass:"m-2",attrs:{variant:"outline-success",size:"sm",disabled:!1},on:{click:t.onClickShortcut}},[t._v("すこ")])],1)],1),n("b-alert",{staticClass:"mt-3",attrs:{show:t.isError,variant:"danger"}},[t._v("\n        Connection fail.\n      ")])],1)],1)],1)},V=[],G=n("f499"),K=n.n(G),U={data:function(){return{comment:"",commentLimit:50,isDisabled:!1,isSending:!1,isError:!1,socket:null,eventTimeout:{reopen:null},eventInterval:{sendPing:null}}},computed:{commentState:function(){return this.comment.length>0&&this.comment.length<=this.commentLimit}},methods:{onSubmit:function(t){var e=this;t.preventDefault(),this.isDisabled=!0,this.isSending=!0,window.setTimeout(function(){e.isDisabled=!1,e.isSending=!1,e.comment=""},1e3),this.sendMsg(this.comment)},onClickShortcut:function(t){t.target.disabled=!0,window.setTimeout(function(){t.target.disabled=!1},1e3),this.sendMsg(t.target.textContent)},sendMsg:function(t){this.socket.send(K()({comment:t}))},connectionWS:function(){var t=this;this.socket=new W["w3cwebsocket"]("ws://".concat(window.location.host,"/ws/").concat(this.$route.params.id)),this.socket.onopen=function(e){window.console.log("websocket open"),window.console.log(e),t.isError=!1},this.socket.onerror=function(t){window.console.log("websocket error"),window.console.log(t)},this.socket.onclose=function(e){window.console.log("websocket close"),window.console.log(e),t.isError=!0,t.eventTimeout.reopen=window.setTimeout(function(){t.connectionWS()},1e3)}}},created:function(){this.connectionWS()},mounted:function(){},destroyed:function(){this.socket.close(),window.clearTimeout(this.eventTimeout.reopen)}},X=U,Y=Object(a["a"])(X,J,V,!1,null,null,null),Z=Y.exports;o["a"].use(m["a"]);var tt=new m["a"]({mode:"history",routes:[{path:"/",component:g},{path:"/live",component:B},{path:"/comment/:id",component:Z}]}),et=n("2f62");o["a"].use(et["a"]);var nt=new et["a"].Store({state:{bgColor:"white",timer:{time:3e5,count:0,active:!1},livekey:null},mutations:{setColor:function(t,e){t.bgColor=e},countTimer:function(t,e){t.timer.count+=e,t.timer.count>=t.timer.time&&(t.timer.count=t.timer.time)},activeTimer:function(t,e){t.timer.active=e},stopTimer:function(t){t.timer.active=!1,t.timer.count=0},livekey:function(t,e){t.livekey=e}}}),ot=n("9f7b"),it=n.n(ot);n("f9e3"),n("2dd8");o["a"].use(it.a);var st=n("ecee"),ct=n("c074"),rt=n("ad3d");st["c"].add(ct["a"]),o["a"].component("font-awesome-icon",rt["a"]),o["a"].config.productionTip=!1,new o["a"]({router:tt,store:nt,render:function(t){return t(u)}}).$mount("#app")},7552:function(t,e,n){},ba4a:function(t,e,n){"use strict";var o=n("c5a5"),i=n.n(o);i.a},c5a5:function(t,e,n){},f4f6:function(t,e,n){}});
//# sourceMappingURL=app.83169ff4.js.map